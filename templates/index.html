{% extends "templates/index.html" %}

{% block main %}
<div id="main" class="container">
  <div class="row">
    <h4 class="text-center logo-subtext">Flatiron Institute</h4>
    <div class="col-lg-10 col-lg-offset-1">

      {% block form %}
      <form id="build-form" class="form jumbotron">
        <h4 id="form-header" class='row'>Choose project</h4>
        <input type="hidden" id="provider_prefix" value="user"/>
        <div class="form-group row">
          <label for="repository">Flatiron user</label>
          <div class="input-group">
            <input class="form-control" type="text" id="repository" data-lpignore="true" placeholder="user"/>
          </div>
        </div>
        <div class="form-row row">
          <div class="form-group col-md-4">
            <label for="ref">Project</label>
            <input class="form-control" type="text" id="ref" placeholder="project"/>
          </div>
          <div class="form-group col-md-6">
            <label for="filepath"></label>
            <div class="input-group">
              <input class="form-control" type="text" id="filepath"
                placeholder=""
              />
              <div class="input-group-btn" id="url-or-file-btn">
                <button type="button" class="btn btn-secondary dropdown-toggle"
                  data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
                  title="Specify whether the path to open is a URL or a file"
                >
                <span id="url-or-file-selected">
                {{ 'URL' if urlpath else 'File' }}
                </span>
                <span class="caret"></span>
                </button>
                <ul class="dropdown-menu">
                  <li class="dropdown-item"><a href="#">File</a></li>
                  <li class="dropdown-item"><a href="#">URL</a></li>
                </ul>
              </div>
            </div>
          </div>

          <div class="form-group col-md-2">
            <div class="btn-group" id="launch-buttons">
              <button id="submit" class="btn-submit" type="submit">launch</button>
            </div>
          </div>
        </div>

        <div id="build-progress" class="progress on-build hidden row">
          <div id="phase-failed" class="progress-bar progress-bar-danger progress-bar-striped hidden" style="width: 100%">
            Failed
          </div>
          <div id="phase-waiting" class="progress-bar progress-bar-danger progress-bar-striped active hidden" style="width: 10%">
            Waiting
          </div>
          <div id="phase-already-built" class="progress-bar progress-bar-warning progress-bar-striped active hidden" style="width: 90%">
            Already built!
          </div>
          <div id="phase-building" class="progress-bar progress-bar-warning progress-bar-striped active hidden" style="width: 40%">
            Building
          </div>
          <div id="phase-pushing" class="progress-bar progress-bar-info progress-bar-striped active hidden" style="width: 40%">
            Pushing
          </div>
          <div id="phase-launching" class="progress-bar progress-bar-success progress-bar-striped active hidden" style="width: 10%">
            Launching
          </div>
        </div>

        <div id="log-container" class="panel panel-default on-build hidden row">
          <div id="toggle-logs" class="panel-heading">
            Build logs
            <button type="button" class="btn btn-link btn-xs pull-right">show</button>
          </div>
          <div class="panel-body hidden">
            <div id="log"></div>
          </div>
        </div>
      </form>
      {% endblock form %}
    </div>
    <div class="col-md-1">
      <a href="{{hub_url}}">Check your currently running server.</a>
    </div>
  </div>
</div>
{% endblock main %}

{% block footer %}
<script type="text/javascript">
indexMain();
</script>
{% endblock footer %}
